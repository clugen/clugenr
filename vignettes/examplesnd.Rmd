---
title: "Examples in other dimensions"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Examples in other dimensions}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

This vignette contains a number of examples on how to use `clugenr` in 1D and
5D. Each example must be preceded with:

```{r setup, message=FALSE, warning=FALSE}
library(clugenr)    # The clugenr library
library(ggplot2)     # Required for plotting

# Keep examples reproducible in newer R versions 
RNGversion("3.6.0") 

# Marker style for 2D plots
marker2d <- list(size = 4, line = list(color = 'black', width = 0.2))
```

#### Basic 1D example with density plot

```{r}
# Custom proj_dist_fn: point projections placed using the Beta distribution
proj_beta <- function(len, n) len * rbeta(n, 0.1, 0.1) - len / 2
seed <- 123
```

```{r}
set.seed(seed)
e79 = clugen(1, 3, 2000, 1, 0, 10, 6, 1.5, 0)
e80 = clugen(1, 3, 2000, 1, 0, 10, 6, 1.5, 0, proj_dist_fn = "unif")
e81 = clugen(1, 3, 2000, 1, 0, 10, 6, 1.5, 0, proj_dist_fn = proj_beta)


```


```julia
# Custom proj_dist_fn: point projections placed using the Laplace distribution
proj_laplace(len, n, rng) = rand(rng, Laplace(0, len / 6), n)

e79 = clugen(1, 3, 2000, [1], 0, [10], 6, 1.5, 0; rng = StableRNG(45))
e80 = clugen(1, 3, 2000, [1], 0, [10], 6, 1.5, 0; proj_dist_fn = "unif", rng = StableRNG(45))
e81 = clugen(1, 3, 2000, [1], 0, [10], 6, 1.5, 0; proj_dist_fn = proj_laplace, rng = StableRNG(45))

p79 = plot(e79.points, seriestype = :density, group=e79.point_clusters, fill=true, fillalpha=0.35, legend=nothing, title="e79: proj_dist_fn=\"norm\" (default)", titlefontsize=9, color=theme_palette(:auto).colors.colors', xlim=(-19,4), ylim=(-0.09, 0.85), aspect_ratio=12, xlabel="\$x\$", grid=false, showaxis=:x, framestyle=:zerolines, yticks=false)
plot!(p79, e79.points, -0.04 .* ones(sum(e79.cluster_sizes)), seriestype = :scatter, group=e79.point_clusters, markersize=2.5, markerstrokewidth=0.1, legend=nothing, color=theme_palette(:auto).colors.colors')

p80 = plot(e80.points, seriestype = :density, group=e80.point_clusters, fill=true, fillalpha=0.35, legend=nothing, title="e80: proj_dist_fn=\"unif\"", titlefontsize=9, color=theme_palette(:auto).colors.colors', xlim=(-19,4), ylim=(-0.09, 0.85), aspect_ratio=12, xlabel="\$x\$", grid=false, showaxis=:x, framestyle=:zerolines, yticks=false)
plot!(p80, e80.points, -0.04 .* ones(sum(e80.cluster_sizes)), seriestype = :scatter, group=e80.point_clusters, markersize=2.5, markerstrokewidth=0.1, legend=nothing, color=theme_palette(:auto).colors.colors')

p81 = plot(e81.points, seriestype = :density, group=e81.point_clusters, fill=true, fillalpha=0.35, legend=nothing, title="e81: custom proj_dist_fn (Laplace)", titlefontsize=9, color=theme_palette(:auto).colors.colors', xlim=(-19,4), ylim=(-0.09, 0.85), aspect_ratio=12, xlabel="\$x\$", grid=false, showaxis=:x, framestyle=:zerolines, yticks=false)
plot!(p81, e81.points, -0.04 .* ones(sum(e81.cluster_sizes)), seriestype = :scatter, group=e81.point_clusters, markersize=2.5, markerstrokewidth=0.1, legend=nothing, color=theme_palette(:auto).colors.colors')
```

